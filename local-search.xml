<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Linux备忘录</title>
    <link href="/2023/12/15/Linux%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <url>/2023/12/15/Linux%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p>linux命令长时间不写就会忘记，所以写篇博客记录一下！</p>          </div><h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><p>使用 <a href="https://github.com/PowerShell/Win32-OpenSSH">Win32-OpenSSH</a> 运行服务器，首先打开cmd，输入</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> root@<span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure><p>其中root为账户名，127.0.0.1为ip地址，当然您也可以使用在.ssh中设置的别名</p><p>.ssh文件夹位于 %USERPROFILE% 目录下 <code>C:\Users\Administrator.DESKTOP-1A2DGNK.ssh</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Host</span> moc<br><span class="hljs-attribute">HostName</span> <span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">User</span> root<br><span class="hljs-attribute">ServerAliveInterval</span> <span class="hljs-number">60</span><br><span class="hljs-attribute">IdentityFile</span> C:\Users\Administrator.DESKTOP-<span class="hljs-number">1</span>A2DGNK\.ssh\moc<br></code></pre></td></tr></table></figure><ul><li>moc 别名</li><li>User 账户</li><li>ServerAliveInterval 心跳间隔</li><li>IdentityFile 密钥文件</li></ul><p>经过上述配置后，您可以使用以下的命令来进行链接</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh moc</span><br></code></pre></td></tr></table></figure><blockquote><p>如果要尝试使用以上命令，则必须在环境变量中配置ssh否则无法直接使用！</p></blockquote><h2 id="SSH安全性"><a href="#SSH安全性" class="headerlink" title="SSH安全性"></a>SSH安全性</h2><div class="note note-danger">            <p>如果仅设置了密码登录，存在被爆破的风险，而且root用户无法远程登录</p>          </div><p>这里采用Win32-OpenSSH为例，介绍如何使用密钥登录的方式来防范风险</p><ul><li>首先打开<code>Win32-OpenSSH</code>的文件 , 点击<code>ssh-keygen.exe</code>运行</li></ul><p>一共需要输入3次，分别为</p><ul><li>密钥的文件名</li><li>密钥的密码</li><li>密码确认密码</li></ul><blockquote><p>若不想输入密码 2、3次直接按回车即可</p></blockquote><p>输入完成后会在根目录下生成文件</p><ul><li>文件名</li><li>文件名.pub</li></ul><p>其中后缀名为.pub需要放入在服务器上，打开ssh远程链接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#进入.ssh目录</span><br><span class="hljs-built_in">cd</span> .ssh<br><br><span class="hljs-comment">#创建authorized_keys文件，如果存在则直接编辑即可</span><br><span class="hljs-built_in">touch</span> authorized_keys &gt;&gt; 您的pub文件内的内容<br></code></pre></td></tr></table></figure><p>pub文件的内容是这种形式 ssh-rsa xxxxxx</p><p><strong>没有后缀名的文件为登录私钥，一定要妥善保存，否则后续可能会无法链接到服务器！！！！</strong></p><ul><li>然后打开ssh配置项</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs BASH"><span class="hljs-built_in">cd</span> /etc/ssh<br>vi sshd_config<br></code></pre></td></tr></table></figure><p>修改以下配置</p><ul><li><p><strong>允许密钥登录</strong><br>PubkeyAuthentication yes</p></li><li><p><strong>允许root登录（此项可能存在风险）</strong><br>PermitRootLogin yes</p></li><li><p><strong>存放pub密钥的文件路径</strong><br>AuthorizedKeysFile .ssh&#x2F;authorized_keys .ssh&#x2F;authorized_keys2</p></li><li><p><strong>关闭密码登录（即仅允许密钥方式的登录）</strong><br>PasswordAuthentication no</p></li></ul><p>以上配置保存完毕后，输入 systemctl restart sshd.service 重启ssh服务，即可完成上述配置！</p><h2 id="包管理器"><a href="#包管理器" class="headerlink" title="包管理器"></a>包管理器</h2><p>linux中的包管理器真的是非常的好用，仅需要几个字母便可以直接安装&#x2F;卸载&#x2F;更新软件</p><div class="note note-success">            <p><span style="color:green;"> # 安装 </span><br>apt install xxx</p><p><span style="color:green;"> # 重新安装</span><br>apt reinstall xxx</p><p><span style="color:green;"> # 移除</span><br>apt remove xxx</p><p><span style="color:green;"> # 包源更新</span><br>apt update</p><p><span style="color:green;"> # 更新</span><br>apt upgrade</p>          </div><p>由于国内特殊的网络原因，导致访问这些软件时下载更新很慢，鉴于此可以参考使用<a href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/">清华大学镜像源</a>来解决此问题</p><p>使用vi编辑&#x2F;etc&#x2F;apt&#x2F;sources.list,修改如下</p><div class="note note-success">            <p><span style="color:green;"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><strong>deb <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy main restricted universe multiverse</strong></p><p># deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy main restricted universe multiverse<br><strong>deb <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-updates main restricted universe multiverse</strong></p><p># deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-updates main restricted universe multiverse<br><strong>deb <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-backports main restricted universe multiverse</strong></p><p># deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-backports main restricted universe multiverse</p><p># deb <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-security main restricted universe multiverse<br># # deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-security main restricted universe multiverse</p><p><strong>deb <a href="http://security.ubuntu.com/ubuntu/">http://security.ubuntu.com/ubuntu/</a> jammy-security main restricted universe multiverse</strong><br># # deb-src <a href="http://security.ubuntu.com/ubuntu/">http://security.ubuntu.com/ubuntu/</a> jammy-security main restricted universe multiverse</p><p># 预发布软件源，不建议启用<br># deb <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-proposed main restricted universe multiverse<br># # deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu/</a> jammy-proposed main restricted universe multiverse</p>          </div><p>使用包管理器安装的部分软件可能版本过老，如果遇到此情况的话请参考下列官方文档教程处理（其他软件大同小异不做过多赘述）</p><ul><li><a href="https://nginx.org/en/linux_packages.html#Ubuntu">Nginx</a></li><li><a href="https://redis.io/docs/getting-started/installation/install-redis-on-linux/">Redis</a></li></ul><h2 id="系统代理"><a href="#系统代理" class="headerlink" title="系统代理"></a>系统代理</h2><p>打开&#x2F;etc&#x2F;environment文件</p><p>在文件中增加如下内容，然后:wq保存后reboot机器即可正常使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs BASH">http_proxy=<span class="hljs-string">&quot;http://ip:port/&quot;</span><br>https_proxy=<span class="hljs-string">&quot;http://ip:port/&quot;</span><br>no_proxy=<span class="hljs-string">&quot;localhost, 127.0.0.1&quot;</span><br></code></pre></td></tr></table></figure><h2 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h2><p>打开 <code>/etc/systemd/system/</code> 文件夹</p><p>新建一个文件，文件名称以<code>xxx.service</code>格式</p><p>然后键入如下的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs BASH">[Unit]<br>Description=subconverter<br><br>[Service]<br>WorkingDirectory=/root/subconverter<br>ExecStart=/root/subconverter/subconverter<br>Restart=always<br>RestartSec=3 <br>SyslogIdentifier=dotnet-example<br>User=root<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure><ul><li>Description 说明</li><li>WorkingDirectory 工作目录</li><li>ExecStart 执行命令</li><li>RestartSec 启动次数</li><li>User 运行的角色</li></ul><p>编辑完成后输入如下的命令</p><ul><li>systemctl daemon-reload 重载</li><li>systemctl enable xxx.service 启用服务</li><li>systemctl restart xxx.service 启动服务</li><li>systemctl status xxx.service 获取服务状态</li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>[1] <a href="https://blog.dreamogi.com/posts/linux-memo/">Linux备忘录</a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Vue3 使用ArcoDesign</title>
    <link href="/2023/12/15/vue3-ArcoDesign/"/>
    <url>/2023/12/15/vue3-ArcoDesign/</url>
    
    <content type="html"><![CDATA[<!-- Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues). --><h2 id="关于-ArcoDesign"><a href="#关于-ArcoDesign" class="headerlink" title="关于 ArcoDesign"></a>关于 ArcoDesign</h2><p><a href="https://arco.design/vue/docs/start">ArcoDesign</a> 是基于字节跳动公司内部的 Byte Design 升级而来，在打磨了近 3 年之后，通过字节内部大量业务沉淀和验证在前两天由掘金举办的《稀土开发者大会2021》上开源了，这不仅仅是一款 UI 组件库，而是一个能力全面的企业级产品设计系统。</p><h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">npm install --save-dev @arco-design/web-vue<br></code></pre></td></tr></table></figure><h3 id="在main-js内引入"><a href="#在main-js内引入" class="headerlink" title="在main.js内引入"></a>在main.js内引入</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ArcoVue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@arco-design/web-vue&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span>;<br><span class="hljs-comment">//完整引入css -不推荐</span><br><span class="hljs-comment">// import &#x27;@arco-design/web-vue/dist/arco.css&#x27;;</span><br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">ArcoVue</span>); <span class="hljs-comment">//将acro挂载到vue上</span><br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="按需加载（模板）"><a href="#按需加载（模板）" class="headerlink" title="按需加载（模板）"></a>按需加载（模板）</h3><blockquote><p>安装所需插件      npm install -D unplugin-vue-components unplugin-auto-import</p></blockquote><p>安装完成，对 <strong>vite.config.ts</strong> 文件进行配置 </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-auto-import/vite&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/vite&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ArcoResolver</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/resolvers&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title class_">AutoImport</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ArcoResolver</span>()],<br>    &#125;),<br>    <span class="hljs-title class_">Components</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<br>        <span class="hljs-title class_">ArcoResolver</span>(&#123;<br>          <span class="hljs-attr">sideEffect</span>: <span class="hljs-literal">true</span><br>        &#125;)<br>      ]<br>    &#125;)<br>  ]<br>&#125;);<br><br></code></pre></td></tr></table></figure><h3 id="按需加载（样式）"><a href="#按需加载（样式）" class="headerlink" title="按需加载（样式）"></a>按需加载（样式）</h3><blockquote><p>安装所需插件      npm install vite-plugin-style-import –save-dev</p></blockquote><p>安装完成，对 <strong>vite.config.ts</strong> 文件进行配置 </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><br><br><span class="hljs-comment">// 自动导入vue中hook reactive ref等</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;unplugin-auto-import/vite&quot;</span><br><span class="hljs-comment">//自动导入ui-组件 比如说ant-design-vue  element-plus等</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/vite&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ArcoResolver</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/resolvers&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; createStyleImportPlugin &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-style-import&#x27;</span><br><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title class_">AutoImport</span>(&#123;<br>      <span class="hljs-comment">//安装两行后你会发现在组件中不用再导入ref，reactive等</span><br>      <span class="hljs-attr">imports</span>: [<span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;vue-router&#x27;</span>],<br>      <span class="hljs-comment">//存放的位置</span><br>      <span class="hljs-attr">dts</span>: <span class="hljs-string">&quot;src/auto-import.d.ts&quot;</span>,<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ArcoResolver</span>()],<br>    &#125;),<br>    <span class="hljs-title class_">Components</span>(&#123;<br>      <span class="hljs-comment">// 引入组件的,包括自定义组件</span><br>      <span class="hljs-comment">// 存放的位置</span><br>      <span class="hljs-attr">dts</span>: <span class="hljs-string">&quot;src/components.d.ts&quot;</span>,<br>      <span class="hljs-attr">resolvers</span>: [<br>        <span class="hljs-title class_">ArcoResolver</span>(&#123;<br>          <span class="hljs-attr">sideEffect</span>: <span class="hljs-literal">true</span><br>        &#125;)<br>      ]<br>    &#125;),<br>    <span class="hljs-title function_">createStyleImportPlugin</span>(&#123;<br>      <span class="hljs-attr">libs</span>: [<br>        &#123;<br>          <span class="hljs-attr">libraryName</span>: <span class="hljs-string">&#x27;@arco-design/web-vue&#x27;</span>,<br>          <span class="hljs-attr">esModule</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">resolveStyle</span>: <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">// css</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">`@arco-design/web-vue/es/<span class="hljs-subst">$&#123;name&#125;</span>/style/css.js`</span><br>            <span class="hljs-comment">// less</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">`@arco-design/web-vue/es/<span class="hljs-subst">$&#123;name&#125;</span>/style/index.js`</span><br>          &#125;,<br>        &#125;<br>      ]<br>    &#125;)<br>  ],<br>&#125;)<br></code></pre></td></tr></table></figure><blockquote><p>若报 Cannot find module ‘consola’ 这个错误<br>可在控制台输入  npm i consola -D 安装对应插件即可</p></blockquote><p>完成以上步骤 就可以正常使用AcroDesign ui库了 </p><p>vue3+vite+ts+router+pinia+axios <a href="https://blog.csdn.net/weixin_59916662/article/details/127331094?spm=1001.2014.3001.5506">一把梭推荐文章</a></p>]]></content>
    
    
    <categories>
      
      <category>Vue3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue3+vite+ts 常见问题汇总</title>
    <link href="/2023/12/15/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/"/>
    <url>/2023/12/15/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>  为什么写这样一篇文章呢，说到底是被折磨的受不了了，每次创建项目，东西还没怎么写就这报错那报错，烦的一批。所以呢趁着有时间赶紧把这些问题都给它集中起来，以后遇到直接看就行了，不用东搜西搜浪费时间！</p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><h3 id="1-VsCode-写方法出现-event-gt"><a href="#1-VsCode-写方法出现-event-gt" class="headerlink" title="1. VsCode 写方法出现  @event=&gt;"></a>1. VsCode 写方法出现  <code>@event=&gt;</code></h3><p> 在 Vue 中的点击事件 @click 后会自动补全一段“ <code>$event =&gt;</code> ”，这是 VSCode 中setting.json未设置好的缘故</p><p> <img src="/../img/blogimg/4-20/4-20-1.png"><br><em><strong>解决方案</strong></em></p><blockquote><p>点击设置-扩展-Inlay Hints: Event Argument In Inline Handlers 把他的勾选取消即可</p></blockquote><h3 id="2-vue文件引入正确-却出现红色错误波浪线"><a href="#2-vue文件引入正确-却出现红色错误波浪线" class="headerlink" title="2. vue文件引入正确 却出现红色错误波浪线"></a>2. vue文件引入正确 却出现红色错误波浪线</h3><p>在 Vue 文件中，引入外部文件不管你正确不正确都会出现红色的波浪线，产生这个问题的原因是我们使用了ts语法，他只能识别.ts文件，并不能识别.vue文件，所以在引入组件的时候报错了</p><p><img src="/../img/blogimg/4-20/4-20-2.png"></p><p><em><strong>解决方案</strong></em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在 vite-env.d.ts 添加如下代码</span><br><br>declare <span class="hljs-variable language_">module</span> <span class="hljs-string">&quot;*.vue&quot;</span> &#123;<br>    <span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">App</span>, defineComponent &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">component</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> defineComponent&gt; &amp; &#123;<br>        <span class="hljs-title function_">install</span>(<span class="hljs-attr">app</span>: <span class="hljs-title class_">App</span>): <span class="hljs-keyword">void</span>;<br>    &#125;;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> component;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-vue文件引入-“-store-“-出现红色波浪线"><a href="#2-vue文件引入-“-store-“-出现红色波浪线" class="headerlink" title="2. vue文件引入 “ @/store “ 出现红色波浪线"></a>2. vue文件引入 “ <code>@/store</code> “ 出现红色波浪线</h3><p>找不到模块“@&#x2F;…”或其相应的类型声明</p><p><em><strong>解决方案</strong></em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在 tsconfig.json 中添加配置</span><br><span class="hljs-string">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;./&quot;</span>,<span class="hljs-comment">// 解析非相对模块的基础地址，默认是当前目录</span><br>    <span class="hljs-string">&quot;paths&quot;</span>: &#123;<br>    <span class="hljs-comment">// 路径映射，相对于baseUrl</span><br>      <span class="hljs-string">&quot;@/*&quot;</span>:[<span class="hljs-string">&quot;src/*&quot;</span>]<br>    &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vue3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>问题汇总</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>初试nginx</title>
    <link href="/2023/12/15/%E5%88%9D%E8%AF%95nginx/"/>
    <url>/2023/12/15/%E5%88%9D%E8%AF%95nginx/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p>作为一年的前端程序员，到现在都没有一台自己的服务器，感觉有点拉跨，所以最近忍痛割爱，耗费巨资买了一台阿里云的一年服务器,虽然买了，但是不知道能用服务器干嘛，我想这不能让他闲着的原则，我就搞起了Linux和nginx在上面测试</p><p>Linux不用我多说，程序员必备技能， nginx呢是目前最火的服务器不用我多说，所以在这些因素下我就开始了痛苦的学习之旅</p>          </div><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><div class="note note-success">            <blockquote><p>我购买的阿里云服务器配置： 2核(vCPU)2 GiB  Ubuntu 22.04 64位</p></blockquote><ul><li><p>安装使用工具 ：<br>Xshell 7 +  Xftp 7     <span class="label label-info"><a href="https://www.netsarang.com/en/xshell/">Xshell官网</a></span></p></li><li><p>连接你的账户 ：<br>在xshell下载安装完成后，打开xshell 登录你的账号，用户名一般默认root 密码则是你在阿里云服务器控制台重置的密码</p></li></ul>          </div><h3 id="2-开始使用"><a href="#2-开始使用" class="headerlink" title="2.开始使用"></a>2.开始使用</h3><div class="note note-info">            <ul><li><p><strong>检查是否有更新</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">apt update<br></code></pre></td></tr></table></figure></li><li><p><strong>更新安装包</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">apt upgrade<br></code></pre></td></tr></table></figure></li><li><p><strong>安装nginx</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">apt install nginx<br></code></pre></td></tr></table></figure></li><li><p><strong>nginx常用命令</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">nginx</span> -s stop        //立即停止服务<br><br>nginx -s quit        //优雅退出(等待进程全部结束)<br><br>nginx -s reload      //热重载<br><br>ps aux | grep nginx  //查看nginx进程<br><br></code></pre></td></tr></table></figure></li><li><p><strong>nginx常用目录</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx">/etc/nginx/nginx.<span class="hljs-attribute">conf</span>      //配置文件目录<br><br>/usr/share/nginx/html      //网页文件目录<br><br></code></pre></td></tr></table></figure></li></ul>          </div><h3 id="3-应用最新的安装包"><a href="#3-应用最新的安装包" class="headerlink" title="3.应用最新的安装包"></a>3.应用最新的安装包</h3><div class="note note-info">            <ul><li><strong>nginx配置key</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">wget https://nginx.org/keys/nginx_signing.key<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">sudo apt-key add nginx_signing.key<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">sudo sh -c &quot;echo &#x27;deb http://nginx.org/packages/mainline/ubuntu/ `lsb_release -cs` nginx&#x27; &gt; /etc/apt/sources.list.d/Nginx.list&quot;<br></code></pre></td></tr></table></figure><ul><li><strong>nginx更新</strong><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">sudo</span> apt-get update        //全部升级<br><br>sudo apt-get install nginx        //升级nginx<br><br></code></pre></td></tr></table></figure></li></ul>          </div><h3 id="4-踩坑专区"><a href="#4-踩坑专区" class="headerlink" title="4.踩坑专区"></a>4.踩坑专区</h3><div class="note note-warning">            <ul><li><p><strong>修改 <code>/usr/share/nginx/html</code> 目录下的 <code>index.html</code> 不生效</strong></p><p> 在 <code>/etc/nginx/conf.d</code>  目录下新建一个 <span class="label label-info">你需要访问的网址</span>.conf  &#x2F;&#x2F; 例如 ： <a href="http://www.moxccc.com/">www.moxccc.com</a>  &#x3D;&gt; moxccc.conf 并进行如下配置</p> <figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">443</span> ssl;<br>    <span class="hljs-attribute">server_name</span>  moxccc.com www.moxccc.com frp.moxccc.com; //这里写你需要访问网址的<span class="hljs-attribute">url</span> 有多个则用空格隔开<br><br>    charset utf-<span class="hljs-number">8</span>;<br><br>    <span class="hljs-comment">#如果是80端口则301转向到https</span><br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$server_port</span> = <span class="hljs-number">80</span> ) &#123;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://<span class="hljs-variable">$host</span><span class="hljs-variable">$request_uri</span>;<br>    &#125;<br><br>    <span class="hljs-comment">#access_log  logs/host.access.log  main;</span><br>    <span class="hljs-section">location</span> / &#123;<br>        <span class="hljs-attribute">root</span>   html;<br>        <span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>    <span class="hljs-attribute">error_page</span>   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  /50x.html;<br>    <span class="hljs-section">location</span> = /50x.html &#123;<br>        <span class="hljs-attribute">root</span>   html;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul>          </div><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>[1] <a href="https://blog.dreamogi.com/posts/lets-encrypt-linux/">Linux下使用Let’s Encrypt配置Nginx SSL证书</a></p>]]></content>
    
    
    <categories>
      
      <category>Nginx</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Linux下使用Let&#39;s Encrypt配置Nginx SSL证书</title>
    <link href="/2023/12/15/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8Let&#39;s%20Encrypt%E9%85%8D%E7%BD%AENginx%20SSL%E8%AF%81%E4%B9%A6/"/>
    <url>/2023/12/15/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8Let&#39;s%20Encrypt%E9%85%8D%E7%BD%AENginx%20SSL%E8%AF%81%E4%B9%A6/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p>白嫖的ssl证书谁能不爱呢，还可以设置自动续期，基本上算是永久的，话不多说，看我表演。</p>          </div><h2 id="使用acme-sh"><a href="#使用acme-sh" class="headerlink" title="使用acme.sh"></a>使用acme.sh</h2><p><a href="https://github.com/acmesh-official/acme.sh">acme.sh文档地址</a></p><h3 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">curl https</span>://get.acme.sh | sh -s email=my@moxccc.com<br></code></pre></td></tr></table></figure><h3 id="安装完成进入acme-sh目录"><a href="#安装完成进入acme-sh目录" class="headerlink" title="安装完成进入acme.sh目录"></a>安装完成进入<code>acme.sh</code>目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ./.acme.sh<br></code></pre></td></tr></table></figure><h3 id="自动配置dns"><a href="#自动配置dns" class="headerlink" title="自动配置dns"></a>自动配置dns</h3><p>由于我这里使用的是阿里云 来配置域名解析修改，其他的域名提供商请查看此处<a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi#11-use-aliyun-domain-api-to-automatically-issue-cert">dnsapi</a></p><ul><li><p>首先去阿里云网站申请<code>AccessKey</code>( 请注意保管! )</p></li><li><p>然后修改acme的配置项</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs BASH"><span class="hljs-built_in">cd</span> /root/.acme.sh<br></code></pre></td></tr></table></figure></li><li><p>修改account.conf</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">Ali_Key</span>=<span class="hljs-string">&quot;***&quot;</span><br><span class="hljs-built_in">export</span> <span class="hljs-attribute">Ali_Secret</span>=<span class="hljs-string">&quot;***&quot;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="颁发证书"><a href="#颁发证书" class="headerlink" title="颁发证书"></a>颁发证书</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs LINUX">acme.sh  --issue -d moxccc.com  -d &#x27;*.moxccc.com&#x27;  --dns dns_ali<br></code></pre></td></tr></table></figure><blockquote><p>若想颁发多个域名 则按照 <code>-d 域名.com</code>  <code>-d &#39;*.域名.com&#39;</code> 在 –dns 前添加即可</p></blockquote><h2 id="查看证书信息"><a href="#查看证书信息" class="headerlink" title="查看证书信息"></a>查看证书信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs LINUX">acme.sh --info -d dreamogi.com<br></code></pre></td></tr></table></figure><h2 id="自动续期"><a href="#自动续期" class="headerlink" title="自动续期"></a>自动续期</h2><p>由于证书的有效期为3个月,所以需要进行自动续期，具体内容参见<a href="https://github.com/acmesh-official/acme.sh#12-how-to-renew-the-certs">How to renew the certs</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs LINUX">acme.sh --renew -d dreamogi.com --force<br></code></pre></td></tr></table></figure><h2 id="生成证书后重载Nginx"><a href="#生成证书后重载Nginx" class="headerlink" title="生成证书后重载Nginx"></a>生成证书后重载Nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs LINUX">acme.sh --install-cert -d dreamogi.com \<br>--key-file       /path/to/keyfile/in/nginx/key.pem  \<br>--fullchain-file /path/to/fullchain/nginx/cert.pem \<br>--reloadcmd     &quot;service nginx force-reload&quot;<br></code></pre></td></tr></table></figure><h2 id="Nginx-配置SSH"><a href="#Nginx-配置SSH" class="headerlink" title="Nginx 配置SSH"></a>Nginx 配置SSH</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># 证书配置</span><br><span class="hljs-attribute">ssl_certificate</span>      /root/.acme.sh/moxccc.com_ecc/fullchain.cer;<br><span class="hljs-attribute">ssl_certificate_key</span>  /root/.acme.sh/moxccc.com_ecc/moxccc.com.key;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSL</tag>
      
      <tag>Nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Github使用Webhook功能实现自动更新</title>
    <link href="/2023/12/15/Github%E4%BD%BF%E7%94%A8Webhook%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/"/>
    <url>/2023/12/15/Github%E4%BD%BF%E7%94%A8Webhook%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p>有一天我在敲代码，网站要改几个东西，我就写完打包然后上传服务器，然后我的后端大佬说你天天手动传不累吗，我给你搞一个自动推送，一开始我还没在意，觉得这个不适用不如自己上传方便，过了一会，大佬叫我试试，我就提了一个，网站页面就自动更新了，我才发现这东西是真香呀，后面和大佬探讨了一下，就是通过github的webhooks功能，每次推送代码github就会请求你的接口，然后你在接口里处理逻辑，安装依赖、打包再移动到网站目录下，就可以实现自动刷新。后面用的非常巴适，就想着用前端代码将其实现(后端大佬用的是C#),结果就有了这篇博客，废话不多说让我们开始吧</p>          </div><h2 id="配置GitHub"><a href="#配置GitHub" class="headerlink" title="配置GitHub"></a>配置GitHub</h2><p><img src="/../img/blogimg/23-12-15/01.png"></p><h2 id="部署环境"><a href="#部署环境" class="headerlink" title="部署环境"></a>部署环境</h2><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><p>首先需要一台Linux服务器，但这个写项目的都是人手一台，这里就不过多拓展了</p><h4 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h4><p>作为一个前端，写接口第一个想到的就是<code>node.js</code>，本项目也将使用<code>node.js</code>进行部署接口，那么如何在linux上安装node呢?<br><a href="https://github.com/nodesource/distributions">这里给大家推荐个仓库，对于在linux上安装node写的很详细</a></p><blockquote><p>查看是否安装成功：在linux 上输入命令 node-v 若出现 v20.10.0 则表示安装成功 </p></blockquote><h2 id="项目编写"><a href="#项目编写" class="headerlink" title="项目编写"></a>项目编写</h2><ol><li>安装依赖包<ul><li>body-parser：解析 HTTP 请求体的中间件。它用于处理 JSON、Raw、Text 和 URL 编码格式的数据。</li><li>cors：处理跨源资源共享（CORS）的中间件。CORS允许或拒绝来自不同源的 web 应用对你的服务器资源的访问。</li><li>express：提供了一套丰富的功能用于开发 web 和移动应用程序。 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node">npm install body-parser cors express --save<br></code></pre></td></tr></table></figure></li></ul></li><li>在项目文件下 新建 <code>app.js</code> 用来启动服务<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">//app.js</span><br><br>const express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br>const bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;body-parser&#x27;</span>)<br>const app = <span class="hljs-built_in">express</span>()<br><br>app<span class="hljs-selector-class">.use</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)())<br>app<span class="hljs-selector-class">.use</span>(express<span class="hljs-selector-class">.json</span>())<br><br><span class="hljs-comment">//使用body-parser中间件</span><br>app<span class="hljs-selector-class">.use</span>(<br>  bodyParser<span class="hljs-selector-class">.urlencoded</span>(&#123;<br>    extended: false<br>  &#125;)<br>)<br>app<span class="hljs-selector-class">.use</span>(bodyParser<span class="hljs-selector-class">.json</span>())<br><br>app<span class="hljs-selector-class">.listen</span>(<span class="hljs-number">8080</span>, () =&gt; &#123;<br>  console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;服务启动成功&#x27;</span>)<br>&#125;)<br><br></code></pre></td></tr></table></figure></li><li>在项目文件下 新建 <code>router\api\github.js</code> 用来写接口<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//github.js</span><br><br><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>); <span class="hljs-comment">//用来破解github webhook的密钥</span><br><br><span class="hljs-keyword">const</span> &#123; exec &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;child_process&#x27;</span>);; <span class="hljs-comment">//使用linux命令</span><br><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<br><span class="hljs-keyword">const</span> execAsync = util.<span class="hljs-title function_">promisify</span>(exec); <span class="hljs-comment">//解决exec的回调地狱</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>); <span class="hljs-comment">//文件系统操作</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* <span class="hljs-doctag">@swagger</span></span><br><span class="hljs-comment">* /api/github/webhook:</span><br><span class="hljs-comment">*   post:</span><br><span class="hljs-comment">*     summary: 本地项目上传github自动打包覆盖网页代码</span><br><span class="hljs-comment">*     tags: [GitHub]</span><br><span class="hljs-comment">*     responses:</span><br><span class="hljs-comment">*       200:</span><br><span class="hljs-comment">*         description: Success</span><br><span class="hljs-comment">*         content:</span><br><span class="hljs-comment">*           application/json:</span><br><span class="hljs-comment">*             schema:</span><br><span class="hljs-comment">*               type: object</span><br><span class="hljs-comment">*               properties:</span><br><span class="hljs-comment">*                 message:</span><br><span class="hljs-comment">*                   type: string</span><br><span class="hljs-comment">*                   description: 提示消息</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">gitVueHook</span> = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-comment">// 从请求头中获取签名</span><br>  <span class="hljs-keyword">const</span> signature = req.<span class="hljs-property">headers</span>[<span class="hljs-string">&#x27;x-hub-signature-256&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (!signature) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;未授权访问&quot;</span> &#125;);<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> secret = <span class="hljs-string">&#x27;XXXXX&#x27;</span>; <span class="hljs-comment">//此处则是你在github webhooks设置的Secret</span><br>  <span class="hljs-keyword">const</span> payload = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(req.<span class="hljs-property">body</span>);<br>  <span class="hljs-keyword">const</span> hash = <span class="hljs-string">`sha256=<span class="hljs-subst">$&#123;crypto.createHmac(<span class="hljs-string">&#x27;sha256&#x27;</span>, secret).update(payload).digest(<span class="hljs-string">&#x27;hex&#x27;</span>)&#125;</span>`</span>;<br>  <span class="hljs-keyword">if</span> (!crypto.<span class="hljs-title function_">timingSafeEqual</span>(<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(hash), <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(signature))) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;签名不匹配&quot;</span> &#125;);<br>  &#125;<br>  <br>  <span class="hljs-comment">//此处代表签名匹配成功</span><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> message = <span class="hljs-keyword">await</span> <span class="hljs-title function_">deleteAndCloneRepository</span>();<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>(&#123; message &#125;);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;无法更新或克隆仓库。&#x27;</span> &#125;);<br>  &#125;<br><br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REPO_URL</span> = <span class="hljs-string">&#x27;https://github.com/moxccc/githook.git&#x27;</span>; <span class="hljs-comment">// 你的仓库 URL</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REPO_PATH</span> = <span class="hljs-string">`/var/git/githook`</span>; <span class="hljs-comment">// 设置仓库路径</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MOVE_PATH</span> = <span class="hljs-string">&#x27;/var/www/preview&#x27;</span>; <span class="hljs-comment">// 设置移动的路径</span><br><br><span class="hljs-comment">// 异步删除目录并克隆仓库 --需要npm 的项目</span><br><span class="hljs-keyword">const</span> deleteAndCloneRepository = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 检查是否已经是一个 Git 仓库</span><br>        <span class="hljs-keyword">if</span> (fs.<span class="hljs-title function_">existsSync</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;REPO_PATH&#125;</span>/.git`</span>)) &#123;<br>            <span class="hljs-comment">// 仓库已存在，执行 git pull</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;git pull&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 仓库不存在，执行 git clone</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">`git clone <span class="hljs-subst">$&#123;REPO_URL&#125;</span> <span class="hljs-subst">$&#123;REPO_PATH&#125;</span>`</span>);<br>        &#125;<br>        <span class="hljs-comment">// 执行 npm install 更新依赖</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;npm install&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br><br>        <span class="hljs-comment">// 执行 npm run build 打包</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;npm run build&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br><br>        <span class="hljs-comment">// 移动 dist 文件夹</span><br>        <span class="hljs-keyword">const</span> sourcePath = <span class="hljs-string">`<span class="hljs-subst">$&#123;REPO_PATH&#125;</span>/dist`</span>;<br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">`rm -rf <span class="hljs-subst">$&#123;MOVE_PATH&#125;</span> &amp;&amp; mv <span class="hljs-subst">$&#123;sourcePath&#125;</span> <span class="hljs-subst">$&#123;MOVE_PATH&#125;</span>`</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;仓库操作、依赖安装及文件移动完成。&#x27;</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;操作过程中出错:&#x27;</span>, error);<br>        <span class="hljs-keyword">throw</span> error;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>写完后在app.js引入接口<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//app.js</span><br><br><span class="hljs-comment">// 引入数据api</span><br><span class="hljs-keyword">const</span> github = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./router/api/github&#x27;</span>)<br><br><span class="hljs-comment">// 使用router中间件</span><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/github/webhook&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  github.<span class="hljs-title function_">gitVueHook</span>(req, res)<br>&#125;);<br></code></pre></td></tr></table></figure>设置开机自启，不理解的可以看我的另一篇文章 <a href="/2023/12/15/Linux%E5%A4%87%E5%BF%98%E5%BD%95/" title="Linux备忘录">Linux备忘录</a><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs abnf">cd  /etc/systemd/system/ <br>touch node.service<br>vi node.service<br><br>//node.service内容如下：<br><br>[Unit]<br><span class="hljs-attribute">Description</span><span class="hljs-operator">=</span>subconverter<br><br>[Service]<br><span class="hljs-attribute">WorkingDirectory</span><span class="hljs-operator">=/</span>usr/web<br><span class="hljs-attribute">ExecStart</span><span class="hljs-operator">=</span>node app.js<br><span class="hljs-attribute">Restart</span><span class="hljs-operator">=</span>always<br><span class="hljs-attribute">RestartSec</span><span class="hljs-operator">=</span><span class="hljs-number">3</span> <br><span class="hljs-attribute">SyslogIdentifier</span><span class="hljs-operator">=</span>dotnet-example<br><span class="hljs-attribute">User</span><span class="hljs-operator">=</span>root<br><br>[Install]<br><span class="hljs-attribute">WantedBy</span><span class="hljs-operator">=</span>multi-user.target<br><br>//设置开启自启且立即启动<br>systemctl enable node.service –now<br></code></pre></td></tr></table></figure>若要查看node.service的日志，则输入以下命令<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs diff">journalctl -u node.service -e -f<br><br><span class="hljs-deletion">-u: 只显示与特定服务相关的日志</span><br><span class="hljs-deletion">-e: 滚动底部</span><br><span class="hljs-deletion">-f: 有新的日志时，立即显示在屏幕上</span><br></code></pre></td></tr></table></figure></li></ol><p>上面<code>@swagger</code> 是一个swagger接口文档注释，感兴趣的话可以看一下我的<a href="#%E9%A2%9D%E5%A4%96%E7%AF%87-Swagger">swagger教程</a></p><div class="note note-info">            <p>到这里接口就部署成功，我觉得大功告成了,此时我的心情是这样的<img src="/../img/gif/01.gif"><br>大佬问我做完没，我自信满满的说做完了，大佬说如果我给你发了多个请求你接口会怎么样，我当时想着都是我自己提交而且也就多发了几个请求嘛应该能扛得住，我就说没事，大佬叫我加个异步队列，我想着发就发嘛，总不能崩掉吧就没加，后来大佬测试了一下直接G了，然后就被喷了个体无完肤，现在我的心情是这样的<img src="/../img/gif/02.gif?40"></p><p>一番交流下来也暴露我这项目的几个缺点</p><ul><li>项目接口返回慢，因为要全部完成才能返回状态码，基本上要3 ~ 4s</li><li>如果一个人重复提交会导致项目崩溃，可能公司的项目也不会有人这样做，但是万一呢，你可以保证你自己，那其他人呢( 狗头保命 )</li></ul>          </div><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>我大抵是想进步了，躺在床上横竖睡不着，坐起来静静地看着窗外，这悲伤没由得来，黯然的看着电脑上的项目，一个报错的是我的，另一个报错的也是我的。不行，怎么能被这个小东西难住了，然后就开始了我的虚心求教之路，为了解决以上两个问题，和大佬深入交流了一下考虑了kafka、rabbitmq和redis大佬还是还是觉得用Redis好，因为redis部署简单，且自用项目也没有太多需要处理的消息，确定下来后就开始了我的优化之旅，下面给大家看一张大佬发我的这几个的对比图<br><img src="/../img/blogimg/23-12-15/02.png" alt="大佬yyds"></p><ol><li><p>安装redis</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>linux 安装<br>apt install redis-server<br><span class="hljs-regexp">//</span>输入命令redis-cli ping 若提示PONG 则表示安装成功<br><br><span class="hljs-regexp">//</span>node 安装<br>npm install redis<br></code></pre></td></tr></table></figure></li><li><p>使用redis</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//github.js</span><br><br><span class="hljs-comment">// redis 异步队列</span><br><span class="hljs-keyword">const</span> redis = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;redis&#x27;</span>);<br><span class="hljs-keyword">const</span> publisher = redis.<span class="hljs-title function_">createClient</span>(); <span class="hljs-comment">//发送者</span><br><span class="hljs-keyword">const</span> subscriber = redis.<span class="hljs-title function_">createClient</span>(); <span class="hljs-comment">//订阅者</span><br><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">gitVueHook</span> = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br><br>  &lt;!-- 其他代码 --&gt;<br>  <br>  <span class="hljs-comment">//在验证签名成功后给队列发送消息</span><br>  <span class="hljs-comment">// 获取提交人信息</span><br>  <span class="hljs-keyword">const</span> data = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-comment">// 仓库名称</span><br>  <span class="hljs-keyword">const</span> depotName = data.<span class="hljs-property">repository</span>?.<span class="hljs-property">name</span>;<br>  <span class="hljs-comment">// 消息队列所需数据 </span><br>  <span class="hljs-keyword">const</span> taskData = &#123; depotName &#125;;<br><br>  <span class="hljs-comment">// 发布任务</span><br>  publisher.<span class="hljs-title function_">publish</span>(<span class="hljs-string">&#x27;githooks&#x27;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(taskData), <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;发布消息时出错:&#x27;</span>, err);<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;内部服务器错误&quot;</span> &#125;);<br>    &#125;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;ok&quot;</span> &#125;);<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment">//订阅者</span><br>subscriber.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">channel, message</span>) =&gt;</span> &#123;<br>    <span class="hljs-title function_">deleteAndCloneRepository</span>()<br>  &#125;);<br>  <br>subscriber.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;githooks&#x27;</span>);<br><br></code></pre></td></tr></table></figure></li><li><p>优化，如果你的项目使用redis比较少可以将 订阅&#x2F;发布写在一起，如果使用redis的地方比较多的话，我建议是将订阅单独拎出来，防止代码复杂化，若单独写的话你的订阅事件里包含了一个<code>deleteAndCloneRepository</code>方法，所以首先要把这个<code>deleteAndCloneRepository</code>方法单独写成一个js文件，(如果闲麻烦也可以在gihook.js里将这个方法放出来)</p></li></ol><ul><li>新建<code>utils\redis\repositoryActions.js</code>文件 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//repositoryActions.js</span><br><br><span class="hljs-keyword">const</span> &#123; exec &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;child_process&#x27;</span>); <span class="hljs-comment">//使用linux命令</span><br><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<br><span class="hljs-keyword">const</span> execAsync = util.<span class="hljs-title function_">promisify</span>(exec);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br><span class="hljs-comment">// 异步删除目录并克隆仓库</span><br><span class="hljs-keyword">const</span> deleteAndCloneRepository = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">REPO_PATH, REPO_URL, MOVE_PATH</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 检查是否已经是一个 Git 仓库</span><br>        <span class="hljs-keyword">if</span> (fs.<span class="hljs-title function_">existsSync</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;REPO_PATH&#125;</span>/.git`</span>)) &#123;<br>            <span class="hljs-comment">// 仓库已存在，执行 git pull</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;git pull&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 仓库不存在，执行 git clone</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">`git clone <span class="hljs-subst">$&#123;REPO_URL&#125;</span> <span class="hljs-subst">$&#123;REPO_PATH&#125;</span>`</span>);<br>        &#125;<br>        <span class="hljs-comment">// 执行 npm install 更新依赖</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;npm install&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br><br>        <span class="hljs-comment">// 执行 npm run build 打包</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">&#x27;npm run build&#x27;</span>, &#123; <span class="hljs-attr">cwd</span>: <span class="hljs-variable constant_">REPO_PATH</span> &#125;);<br><br>        <span class="hljs-comment">// 移动 dist 文件夹</span><br>        <span class="hljs-keyword">const</span> sourcePath = <span class="hljs-string">`<span class="hljs-subst">$&#123;REPO_PATH&#125;</span>/dist`</span>;<br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">execAsync</span>(<span class="hljs-string">`rm -rf <span class="hljs-subst">$&#123;MOVE_PATH&#125;</span> &amp;&amp; mv <span class="hljs-subst">$&#123;sourcePath&#125;</span> <span class="hljs-subst">$&#123;MOVE_PATH&#125;</span>`</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;仓库操作、依赖安装及文件移动完成。&#x27;</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;操作过程中出错:&#x27;</span>, error);<br>        <span class="hljs-keyword">throw</span> error;<br>    &#125;<br>&#125;<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> =&#123;<br>    deleteAndCloneRepository,<br>&#125;<br></code></pre></td></tr></table></figure></li><li>新建<code>utils\redis\index.js</code>文件 更改订阅者<code>deleteAndCloneRepository</code>方法的引用<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> redis = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;redis&#x27;</span>);<br><span class="hljs-keyword">const</span> subscriber = redis.<span class="hljs-title function_">createClient</span>(); <span class="hljs-comment">// 确保这个是全局的或者在合适的地方初始化</span><br><br><span class="hljs-keyword">const</span> &#123;deleteAndCloneRepository&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./repositoryActions&#x27;</span>); <span class="hljs-comment">// 引入你的异步删除和克隆仓库函数</span><br><br>subscriber.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">channel, message</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> task = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message);<br>    <span class="hljs-keyword">let</span> <span class="hljs-variable constant_">REPO_URL</span> = <span class="hljs-string">&#x27;https://github.com/moxccc/githook.git&#x27;</span>; <span class="hljs-comment">// 你的仓库 URL</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-variable constant_">REPO_PATH</span> = <span class="hljs-string">`/var/git/<span class="hljs-subst">$&#123;task.depotName&#125;</span>`</span>; <span class="hljs-comment">// 设置仓库路径</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-variable constant_">MOVE_PATH</span> = <span class="hljs-string">&#x27;/var/www/githubpreview&#x27;</span>; <span class="hljs-comment">// 设置移动的路径</span><br>    <span class="hljs-title function_">deleteAndCloneRepository</span>(<span class="hljs-variable constant_">REPO_PATH</span>, <span class="hljs-variable constant_">REPO_URL</span>, <span class="hljs-variable constant_">MOVE_PATH</span>)<br>  &#125;);<br>  <br>  subscriber.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;githooks&#x27;</span>);<br></code></pre></td></tr></table></figure></li><li><code>utils\redis\index.js</code>是一个单独的js文件 需要使用node index.js 命令启动，为了便捷，我们将它也设置为开机自启<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs abnf">cd  /etc/systemd/system/ <br>touch node-redis.service<br>vi node-redis.service<br><br>//node-redis.service内容如下：<br><br>[Unit]<br><span class="hljs-attribute">Description</span><span class="hljs-operator">=</span>node_redis<br><br>[Service]<br><span class="hljs-attribute">WorkingDirectory</span><span class="hljs-operator">=/</span>usr/web/utils/redis<br><span class="hljs-attribute">ExecStart</span><span class="hljs-operator">=</span>node index.js<br><span class="hljs-attribute">Restart</span><span class="hljs-operator">=</span>always<br><span class="hljs-attribute">RestartSec</span><span class="hljs-operator">=</span><span class="hljs-number">3</span> <br><span class="hljs-attribute">SyslogIdentifier</span><span class="hljs-operator">=</span>dotnet-example<br><span class="hljs-attribute">User</span><span class="hljs-operator">=</span>root<br><br>[Install]<br><span class="hljs-attribute">WantedBy</span><span class="hljs-operator">=</span>multi-user.target<br><br>//设置开启自启且立即启动<br>systemctl enable node-redis.service –now<br></code></pre></td></tr></table></figure></li></ul><div class="note note-info">            <p>设置redis后，上面的两个问题都被解决了，现在访问接口，耗时只有1.2s左右了，到这里项目就部署完毕，觉得对你有帮助的可以关注我，博客不定时更新，有问题可以在下方留言</p>          </div><h2 id="额外篇-Swagger"><a href="#额外篇-Swagger" class="headerlink" title="额外篇-Swagger"></a>额外篇-Swagger</h2><p><a href="https://swagger.io/tools/swagger-ui/">Swagger</a>是一种用于设计、构建和记录 RESTful API 的开发工具和规范。它的主要目标是帮助开发团队更轻松地设计、测试和文档化 API，以便开发人员、测试人员和其他利益相关者可以更好地理解和使用 API。</p><p>下面给大家介绍如何在node中使用<a href="https://swagger.io/tools/swagger-ui/">Swagger</a></p><ol><li>安装依赖<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span><span class="hljs-keyword">swagger-jsdoc </span><span class="hljs-keyword">swagger-ui-express </span>--save<br></code></pre></td></tr></table></figure></li><li>新建文件 <code>utils\swagger\index.js</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> swaggerJsdoc = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-jsdoc&#x27;</span>);<br><span class="hljs-keyword">const</span> swaggerUi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-ui-express&#x27;</span>);<br><br><span class="hljs-comment">// Swagger定义</span><br><span class="hljs-keyword">const</span> swaggerDefinition = &#123;<br>  <span class="hljs-attr">openapi</span>: <span class="hljs-string">&#x27;3.0.0&#x27;</span>,<br>  <span class="hljs-attr">info</span>: &#123;<br>    <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;moxccc Swagger&#x27;</span>,<br>    <span class="hljs-attr">version</span>: <span class="hljs-string">&#x27;1.0.0&#x27;</span>,<br>  &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 选项配置</span><br><span class="hljs-keyword">const</span> options = &#123;<br>  swaggerDefinition,<br>  <span class="hljs-comment">// 写入API文件的路径</span><br>  <span class="hljs-attr">apis</span>: [path.<span class="hljs-title function_">join</span>(__dirname,<span class="hljs-string">&#x27;../../router/api/*.js&#x27;</span>)],<br>&#125;;<br><br><span class="hljs-keyword">const</span> swaggerSpec = <span class="hljs-title function_">swaggerJsdoc</span>(options);<br><br><span class="hljs-comment">// 导出一个函数，该函数接收应用程序实例并应用Swagger配置</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">setupSwagger</span>(<span class="hljs-params">app</span>) &#123;<br>  app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/Swagger/index.html&#x27;</span>, swaggerUi.<span class="hljs-property">serve</span>, swaggerUi.<span class="hljs-title function_">setup</span>(swaggerSpec));<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = setupSwagger;<br></code></pre></td></tr></table></figure></li><li>在<code>app.js</code>里引用<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> 引入封装的Swagger配置<br>const setupSwagger = require(<span class="hljs-string">&#x27;./utils/swagger&#x27;</span>); <br><span class="hljs-regexp">//</span> 使用封装的Swagger配置<br>setupSwagger(app);<br></code></pre></td></tr></table></figure></li><li>在接口里引入注释<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-comment">//github.js</span><br><br>/**<br><span class="hljs-bullet">* </span>@swagger<br><span class="hljs-bullet">* </span>/api/github/webhook:<br><span class="hljs-bullet">*   </span>post:<br><span class="hljs-bullet">*     </span>summary: 本地项目上传github自动打包覆盖网页代码<br><span class="hljs-bullet">*     </span>tags: [GitHub]<br><span class="hljs-bullet">*     </span>responses:<br><span class="hljs-bullet">*       </span>200:<br><span class="hljs-bullet">*         </span>description: Success<br><span class="hljs-bullet">*         </span>content:<br><span class="hljs-bullet">*           </span>application/json:<br><span class="hljs-bullet">*             </span>schema:<br><span class="hljs-bullet">*               </span>type: object<br><span class="hljs-bullet">*               </span>properties:<br><span class="hljs-bullet">*                 </span>message:<br><span class="hljs-bullet">*                   </span>type: string<br><span class="hljs-bullet">*                   </span>description: 提示消息<br>*/<br></code></pre></td></tr></table></figure></li></ol><div class="note note-info">            <p>重新启动服务 systemctl restart node.service  访问<code>https://网址/Swagger/index.html</code> 即可查看</p>          </div><h2 id="额外篇-接入企业微信机器人"><a href="#额外篇-接入企业微信机器人" class="headerlink" title="额外篇-接入企业微信机器人"></a>额外篇-接入企业微信机器人</h2><p>若是公司项目，可接入企业微信机器人用来发送提示信息，例如：xxx于xxx时间提交了代码，提交信息为xxx</p><ol><li>安装axios<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> axios -S<br></code></pre></td></tr></table></figure></li><li>新建文件<code> utils\apireq\index.js</code> 用于封装机器人发送接口<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;axios&#x27;</span>);<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendWeChatMessage</span>(<span class="hljs-params">content</span>) &#123;<br>    <span class="hljs-keyword">const</span> webhookUrl = <span class="hljs-string">&#x27;xxx&#x27;</span>;<span class="hljs-comment">//机器人请求连接</span><br>    <span class="hljs-keyword">const</span> message = &#123;<br>        <span class="hljs-attr">msgtype</span>: <span class="hljs-string">&#x27;markdown&#x27;</span>,<br>        <span class="hljs-attr">markdown</span>: &#123;<br>            <span class="hljs-attr">content</span>: content<br>        &#125;<br>    &#125;;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(webhookUrl, message);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;消息发送成功:&#x27;</span>, response.<span class="hljs-property">data</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;发送消息时发生错误:&#x27;</span>, error);<br>    &#125;<br>&#125;<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = sendWeChatMessage;<br></code></pre></td></tr></table></figure></li><li>在项目中使用<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 引入机器人</span><br><span class="hljs-keyword">const</span> sendWeChatMessage = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../apireq/index.js&#x27;</span>);<br><br><span class="hljs-comment">//发送消息</span><br><span class="hljs-title function_">sendWeChatMessage</span>(<span class="hljs-string">`【Git】Hot Reload Success`</span>)<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
      <tag>node</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter初试</title>
    <link href="/2023/10/19/Flutter%E5%88%9D%E8%AF%95/"/>
    <url>/2023/10/19/Flutter%E5%88%9D%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p><a href="https://flutter.cn/">Flutter</a> 为软件开发行业带来了革新：只要一套代码库，即可构建、测试和发布适用于移动、Web、桌面和嵌入式平台的精美应用。</p><ul><li><p><strong>快速</strong><br>Flutter 代码可以直接编译成 <code>ARM</code> 或 <code>Intel</code> 平台的机器代码，以及 <code>JavaScript</code> 代码，确保了 Flutter 应用能够拥有原生平台的性能表现。</p></li><li><p><strong>多平台支持</strong><br><strong>触达每个屏幕前的你的用户</strong><br>部署到多种设备，只需要一份代码库，支持移动、网页、桌面和嵌入式设备。</p></li><li><p><strong>开发体验</strong><br><strong>革新性的转变</strong><br>在工程中可以使用插件、自动化测试、开发者工具以及任何可以用来帮助构建高质量应用的工具。</p></li><li><p><strong>稳定可依赖</strong><br><strong>被多数人信赖</strong><br>Flutter 由 Google 支持被并广泛使用，全球性的开发者社区广泛参与和维护，并得到众多世界知名品牌的信任。</p></li><li><p><strong>Dart 编程语言</strong><br><strong>Flutter 由 Dart 强力驱动，助力高效构建全平台应用。</strong></p></li></ul>          </div><h2 id="搭建Flutter开发环境"><a href="#搭建Flutter开发环境" class="headerlink" title="搭建Flutter开发环境"></a>搭建Flutter开发环境</h2><p>Flutter有三个开发平台 macOS、Windows、Liunx、ChromeOS</p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><h4 id="获取Flutter-SDK"><a href="#获取Flutter-SDK" class="headerlink" title="获取Flutter SDK"></a>获取Flutter SDK</h4><ol><li><p>去flutter官网下载其最新可用的安装包，下载地址：<br><a href="https://flutter.dev/docs/development/tools/sdk/releases">https://flutter.dev/docs/development/tools/sdk/releases</a></p><div class="note note-warning">            <p>注意：Flutter的渠道版本会不停变动，请以Flutter官网为准。另外，在中国大陆地区，要想正常获取安装包列表或下载安装包，可能需要翻墙，读者也可以去Flutter github项目下去下载安装包，地址：<a href="https://github.com/flutter/flutter/releases">https://github.com/flutter/flutter/releases</a> 。</p>          </div></li><li><p>将安装包zip解压到你想安装Flutter SDK的路径（如：<code>D:\flutter</code>；注意:不要将flutter安装到需要一些高权限的路径如<code>C:\Program Files\</code>）。</p></li><li><p>在Flutter安装目录的flutter文件下找到<code>flutter_console.bat</code>，双击运行并启动 flutter命令行，接下来，你就可以在Flutter命令行运行flutter命令了。</p></li><li><p>运行 flutter doctor命令<br>在Flutter命令行运行如下命令来查看是否还需要安装其他依赖，如果需要，安装它们：</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">flutter doctor</span><br></code></pre></td></tr></table></figure><p>该命令检查你的环境并在命令行窗口中显示报告。<code>Dart SDK</code>已经在打包在<code>Flutter SDK</code>里了，没有必要单独安装<code>Dart</code>。 仔细检查命令行输出以获取可能需要安装的其他软件或进一步需要执行的任务。<br>例如：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">[-] Android toolchain - develop <span class="hljs-keyword">for</span> Android devices<br>    • Android SDK at D:\Android\sdk<br>    ✗ Android SDK is missing command line tools; download from https:<span class="hljs-regexp">//g</span>oo.gl/XxQghQ<br>    • Try re-installing or updating your Android SDK,<br>      visit https:<span class="hljs-regexp">//</span>flutter.dev<span class="hljs-regexp">/setup/</span><span class="hljs-comment">#android-setup for detailed instructions.</span><br></code></pre></td></tr></table></figure><p>第一次运行flutter命令（如<code>flutter doctor</code>）时，它会下载它自己的依赖项并自行编译。以后再运行就会快得多。缺失的依赖需要安装一下，安装完成后再运行<code>flutter doctor</code>命令来验证是否安装成功。</p></li></ol><h4 id="VSCode-配置和使用Flutter"><a href="#VSCode-配置和使用Flutter" class="headerlink" title="VSCode 配置和使用Flutter"></a>VSCode 配置和使用Flutter</h4><ol><li>安装Flutter和Dart插件</li></ol><ul><li><code>Flutter</code>插件： 支持Flutter开发工作流 (运行、调试、热重载等)。</li><li><code>Dart</code>插件： 提供代码分析 (输入代码时进行验证、代码补全等)。</li></ul><ol start="2"><li>新建项目</li></ol><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><p>待填充</p>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ReactNative初试</title>
    <link href="/2023/09/15/ReactNative%E5%88%9D%E8%AF%95/"/>
    <url>/2023/09/15/ReactNative%E5%88%9D%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><div class="note note-success">            <p><a href="https://reactnative.dev/">React Native</a> 是一个使用 JavaScript 和 React 开发本地Android和iOS应用的框架，他有以下优点: </p><ul><li><p><strong>简单易开发</strong><br>React Native 使你可以创建真正原生的应用，用户体验绝不拉胯。它提供了一些平台无关的抽象核心组件，像是<code>View</code>, <code>Text</code> 以及 <code>Image</code>等，可直接映射渲染为 对应平台的原生UI组件。</p></li><li><p><strong>无缝跨平台</strong><br>通过 React 的声明式组件机制和 JavaScript 代码，现有的原生代码和api可以完美地封装嵌合到 React 组件中。这样既为更多新的开发团队赋予原生应用的开发能力，也能极大地提升现有原生团队的开发效率。</p></li><li><p><strong>秒速刷新</strong><br>保存即刷新  借助 JavaScript 的动态特性， React Native 能够让你光速迭代。</p></li></ul>          </div><h2 id="搭建开发环境"><a href="#搭建开发环境" class="headerlink" title="搭建开发环境"></a>搭建开发环境</h2><p>React Native有三个开发平台 macOS、Windows Liunx</p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><h4 id="首先你需要在你的电脑上先安装-Node、JDK和Android-Studio这些项目依赖后才能进行React-Native项目的创建"><a href="#首先你需要在你的电脑上先安装-Node、JDK和Android-Studio这些项目依赖后才能进行React-Native项目的创建" class="headerlink" title="首先你需要在你的电脑上先安装 Node、JDK和Android Studio这些项目依赖后才能进行React Native项目的创建"></a>首先你需要在你的电脑上先安装 <a href="https://nodejs.org/en">Node</a>、<a href="https://www.oracle.com/java/technologies/downloads/#java11">JDK</a>和<a href="https://developer.android.com/studio">Android Studio</a>这些项目依赖后才能进行React Native项目的创建</h4><div class="note note-warning">            <p>注意事项：</p><ul><li>Node 的版本应大于等于 16，安装完 Node 后建议设置 npm 镜像（淘宝源）以加速后面的过程</li><li>不要使用 cnpm！cnpm 安装的模块路径比较奇怪，packager 不能正常识别！</li><li>React Native 需要 <code>Java Development Kit [JDK] 11</code>,你可以在命令行中输入 <code>javac -version</code>来查看你当前安装的 JDK 版本。如果版本不合要求，则可以去<a href="https://adoptium.net/zh-CN/temurin/releases/?variant=openjdk11&jvmVariant=hotspot">Temurin</a>或<a href="https://www.oracle.com/java/technologies/downloads/#java11">Oracle JDK</a>上下载</li></ul>          </div><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p>React Native 需要通过环境变量来了解你的 Android SDK 装在什么路径，从而正常进行编译。</p><ul><li>右键<code>我的电脑</code>&gt;<code>属性</code>&gt;<code>高级系统设置</code>&gt;<code>高级</code>&gt;<code>环境变量</code>&gt;<code>新建</code>,创建一个名为ANDROID_HOME的环境变量（系统或用户变量均可），指向你的 Android SDK 所在的目录（具体的路径可能和下图不一致，请自行确认）：</li></ul><p><img src="/../img/blogimg/9-15/01.png"></p><ul><li>使用Android Studio 时需要安装模拟器，但是坑人的是他的模拟器只能安装在<code>C盘</code>里面，安装完成后大概能占个5G的存储空间,如果你不想当<code>C盘战士</code>的话就得将他移到别的空闲的磁盘中,这时我们可以定义一个系统变量来改变它的默认路径指向</li></ul><p><img src="/../img/blogimg/9-15/02.png"></p><blockquote><p>我这里是将它的默认路径改在了<code>D:\android_AVD</code>文件夹中,你如果想装在其他的盘中，把变量值改成你文件夹的对应路径即可</p></blockquote><h4 id="创建新项目"><a href="#创建新项目" class="headerlink" title="创建新项目"></a>创建新项目</h4><ol><li>准备工作做完后可以开始创建React Native项目了在你项目文件夹中打开命令提示框 输入<br><code>npx react-native@latest init 项目名称</code><div class="note note-warning">            <p>注意事项：</p><ul><li><p>如果你之前全局安装过旧的<code>react-native-cli</code>命令行工具，请使用<code>npm uninstall -g react-native-cli</code>卸载掉它以避免一些冲突：</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">npm uninstall -g react-<span class="hljs-keyword">native</span>-cli <span class="hljs-meta">@react</span>-<span class="hljs-keyword">native</span>-community/cli<br></code></pre></td></tr></table></figure></li><li><p>文件名中不能使用<code>中文</code>、<code>空格</code>等特殊符号。也不能使用常见的关键字作为项目名（如 <code>class</code>, <code>native</code>, <code>new</code>, <code>package</code> 等等）。也不能使用与核心模块同名的项目名（如 <code>react</code>, <code>react-native</code> 等）。</p></li></ul>          </div></li></ol><p>2.安装成功后的界面应该是这样的</p><p><img src="/../img/blogimg/9-15/03.png"></p><p>3.接下来就可以启动项目了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs BASH"><span class="hljs-comment"># 进入你的项目</span><br><span class="hljs-built_in">cd</span> AwesomeProject<br><br><span class="hljs-comment"># 运行</span><br>npx react-native run-android<br><br><span class="hljs-comment"># 运行完后会打开一个新的命令提示框并显示4个选项</span><br><br>r - reload the app<br>d - open developer menu<br>i - run on iOS<br>a - run on Android <br><br>Android 输入 a 即可<br><br></code></pre></td></tr></table></figure><p><img src="/../img/blogimg/9-15/04.png"><br><img src="/../img/blogimg/9-15/05.png"><br><img src="/../img/blogimg/9-15/06.png"></p><div class="note note-warning">            <p>若启动不成功可能是端口被占用，只需要修改端口号即可</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">npx react-native <span class="hljs-built_in">run</span>-android <span class="hljs-comment">--port=1234</span><br></code></pre></td></tr></table></figure>          </div><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><p>待填充</p>]]></content>
    
    
    <categories>
      
      <category>ReactNative</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReactNative</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
